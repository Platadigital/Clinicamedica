
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cl√≠nica Inteligente</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React e Babel (para traduzir JSX no navegador) -->
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Three.js (para a anima√ß√£o 3D) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <!-- Font Awesome (para √≠cones) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <!-- Estilos personalizados e anima√ß√µes -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }
        .text-shadow { text-shadow: 0px 2px 4px rgba(0,0,0,0.4); }
        .text-shadow-lg { text-shadow: 0px 4px 8px rgba(0,0,0,0.5); }
        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeInDown { animation: fadeInDown 0.8s ease-out forwards; }
        .animate-fadeInUp { animation: fadeInUp 0.8s ease-out forwards; }
        .delay-200 { animation-delay: 0.2s; }
        .delay-400 { animation-delay: 0.4s; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Onde a aplica√ß√£o React ser√° renderizada -->
    <div id="root"></div>

    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, addDoc, setDoc, updateDoc, onSnapshot, collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        // Disponibiliza as fun√ß√µes do Firebase globalmente para o script Babel
        window.firebase = {
            initializeApp,
            getAuth,
            signInAnonymously,
            signInWithCustomToken,
            onAuthStateChanged,
            getFirestore,
            doc,
            getDoc,
            addDoc,
            setDoc,
            updateDoc,
            onSnapshot,
            collection,
            query,
            where,
            getDocs
        };
    </script>

    <!-- Seu c√≥digo React completo (com tipo "text/babel") -->
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        const { initializeApp } = window.firebase;
        const { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } = window.firebase;
        const { getFirestore, doc, getDoc, addDoc, setDoc, updateDoc, onSnapshot, collection, query, where, getDocs } = window.firebase;

        // --- Vari√°veis Globais e Configura√ß√£o do Firebase ---
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        
        let app;
        let db;
        let auth;
        
        // --- Componente HeroSection (Se√ß√£o Principal) ---
        const HeroSection = ({ siteConfig }) => {
          const [videoLoaded, setVideoLoaded] = useState(false);
          const [showPlayButton, setShowPlayButton] = useState(false);
          const videoRef = useRef(null);

          useEffect(() => {
              const videoElement = videoRef.current;
              if (!videoElement) return;

              const handleCanPlay = () => {
                  setVideoLoaded(true);
                  videoElement.play().catch(error => {
                      console.warn("A reprodu√ß√£o autom√°tica foi impedida pelo navegador:", error);
                      setShowPlayButton(true);
                  });
              };
              
              const loadTimeout = setTimeout(() => {
                  if (!videoLoaded) {
                      setShowPlayButton(true);
                  }
              }, 5000);

              videoElement.addEventListener('canplay', handleCanPlay);

              return () => {
                  videoElement.removeEventListener('canplay', handleCanPlay);
                  clearTimeout(loadTimeout);
              };
          }, [siteConfig.heroVideoUrl]);

          const handlePlayButtonClick = () => {
              if (videoRef.current) {
                  videoRef.current.play().then(() => {
                      setShowPlayButton(false);
                  }).catch(error => {
                      console.error("Erro ao tentar reproduzir o v√≠deo:", error);
                  });
              }
          };

          return (
            <header className="relative h-screen flex items-center justify-center overflow-hidden">
              {siteConfig.heroVideoUrl ? (
                <video
                  key={siteConfig.heroVideoUrl}
                  ref={videoRef}
                  autoPlay
                  loop
                  muted
                  playsInline
                  className="absolute z-10 w-auto min-w-full min-h-full max-w-none object-cover"
                  poster={siteConfig.heroPosterUrl || "https://placehold.co/1920x1080/D0F0E0/000000?text=A+carregar+o+v√≠deo..."}
                >
                  <source src={siteConfig.heroVideoUrl} type="video/mp4" />
                  O seu navegador n√£o suporta a tag de v√≠deo.
                </video>
              ) : (
                <img
                  src={siteConfig.heroPosterUrl || "https://placehold.co/1920x1080/D0F0E0/000000?text=V√≠deo+Indispon√≠vel"}
                  alt="Imagem de fundo da cl√≠nica"
                  className="absolute z-10 w-auto min-w-full min-h-full max-w-none object-cover"
                />
              )}

              {showPlayButton && (
                <div className="absolute z-15 inset-0 flex flex-col items-center justify-center bg-gray-900 bg-opacity-70 text-white text-center p-4">
                  <p className="text-xl md:text-2xl font-semibold mb-4">
                    O v√≠deo n√£o iniciou. Clique para reproduzir.
                  </p>
                  <button
                    onClick={handlePlayButtonClick}
                    className="bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3 px-8 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-emerald-300 text-xl"
                  >
                    Reproduzir
                  </button>
                </div>
              )}

              <div className="absolute z-20 inset-0 bg-emerald-900 opacity-40"></div>

              <div className="relative z-30 text-white text-center p-8 rounded-lg bg-emerald-800 bg-opacity-20 backdrop-blur-sm">
                <h1 className="text-6xl md:text-8xl font-extrabold mb-6 animate-fadeInDown text-shadow-lg">
                  {siteConfig.heroTitle || "A Sua Cl√≠nica, Mais Inteligente."}
                </h1>
                <p className="text-2xl md:text-3xl mb-10 animate-fadeInUp delay-200 font-light text-gray-100 text-shadow">
                  {siteConfig.heroSubtitle || "Inova√ß√£o e efici√™ncia para a gest√£o m√©dica, com um toque de excel√™ncia."}
                </p>
                <a
                  href={siteConfig.heroButtonLink || "#sobre"}
                  className="bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-4 px-10 rounded-full shadow-xl transition duration-300 ease-in-out transform hover:scale-105 animate-fadeInUp delay-400 text-xl focus:outline-none focus:ring-4 focus:ring-emerald-300"
                >
                  {siteConfig.heroButtonText || "Saiba Mais"}
                </a>
              </div>
            </header>
          );
        };

        // --- Componente Navbar (Barra de Navega√ß√£o) ---
        const NavLink = ({ href, text, mobile = false, onClick }) => (
          <a
            href={href}
            onClick={onClick}
            className={`block py-2 px-4 rounded-lg text-white font-medium hover:bg-emerald-700 hover:text-emerald-200 transition duration-300 ${mobile ? 'text-lg' : 'text-xl'}`}
          >
            {text}
          </a>
        );

        const Navbar = ({ userId, siteConfig }) => {
          const [isOpen, setIsOpen] = useState(false);
          return (
            <nav className="bg-emerald-800 p-4 shadow-2xl sticky top-0 z-50 bg-opacity-90 backdrop-blur-sm">
              <div className="container mx-auto flex justify-between items-center">
                <a href="#" className="text-white text-4xl font-extrabold rounded-md p-2 hover:text-emerald-200 transition duration-300">
                  {siteConfig.clinicName || "Cl√≠nica Inteligente"}
                </a>
                <div className="md:hidden">
                  <button onClick={() => setIsOpen(!isOpen)} className="text-white focus:outline-none">
                    <svg className="w-9 h-9" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                      {isOpen ? (
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M6 18L18 6M6 6l12 12"></path>
                      ) : (
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M4 6h16M4 12h16M4 18h16"></path>
                      )}
                    </svg>
                  </button>
                </div>
                <div className="hidden md:flex space-x-6 items-center">
                  {siteConfig.navLinks && siteConfig.navLinks.map((link, index) => (
                    <NavLink key={index} href={link.href} text={link.text} />
                  ))}
                  {userId && (
                    <span className="bg-emerald-900 text-emerald-200 text-xs font-mono py-1 px-2 rounded-md">
                      ID: {userId.substring(0, 8)}...
                    </span>
                  )}
                </div>
              </div>
              {isOpen && (
                <div className="md:hidden mt-4 space-y-2 px-2 pb-3">
                  {siteConfig.navLinks && siteConfig.navLinks.map((link, index) => (
                    <NavLink key={index} href={link.href} text={link.text} mobile onClick={() => setIsOpen(false)} />
                  ))}
                  {userId && (
                    <span className="text-white text-sm font-medium py-2 px-4 rounded-md block text-center bg-emerald-700 mt-2">
                      ID: {userId}
                    </span>
                  )}
                </div>
              )}
            </nav>
          );
        };

        // --- Componente FeatureCard (Cart√£o de Funcionalidade) ---
        const FeatureCard = ({ title, description, icon }) => (
          <div className="bg-white p-8 rounded-2xl shadow-lg flex flex-col items-center text-center transform transition duration-300 hover:scale-105 hover:shadow-2xl border border-gray-100">
            <div className="text-6xl mb-4 text-emerald-600">{icon}</div>
            <h3 className="text-2xl font-bold text-emerald-800 mb-3">{title}</h3>
            <p className="text-gray-700 leading-relaxed">{description}</p>
          </div>
        );
        
        // --- Componente PlanCard (Cart√£o de Plano) ---
        const PlanCard = ({ plan }) => (
            <div className={`bg-white p-10 rounded-3xl shadow-lg flex flex-col items-center text-center transition duration-300 hover:shadow-2xl border ${plan.isPopular ? 'border-4 border-emerald-400 transform scale-105' : 'border-gray-100'}`}>
                {plan.isPopular && (
                    <span className="bg-emerald-500 text-white text-base font-bold px-5 py-2 rounded-full mb-6 -mt-16 shadow-md uppercase tracking-wider">
                    Mais Popular
                    </span>
                )}
                <h3 className="text-3xl font-bold text-emerald-700 mb-4">{plan.name}</h3>
                <p className="text-5xl font-extrabold text-emerald-600 mb-6">{plan.price}</p>
                <ul className="text-left text-gray-700 space-y-3 mb-8 w-full">
                    {plan.features.map((feature, idx) => (
                    <li key={idx} className="flex items-center">
                        <svg className="w-6 h-6 text-lime-400 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                        {feature}
                    </li>
                    ))}
                </ul>
                <button className="w-full bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-4 px-8 rounded-xl shadow-lg transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-emerald-300">
                    Assinar Agora
                </button>
            </div>
        );

        // --- Componente SubscriptionPlans (Planos de Assinatura) ---
        const SubscriptionPlans = () => {
            const plans = [
                { name: "B√°sico", price: "R$ 99/m√™s", features: ["Gest√£o de pacientes (at√© 100)", "Agendamento b√°sico", "Suporte por e-mail", "Relat√≥rios mensais"], isPopular: false },
                { name: "Profissional", price: "R$ 249/m√™s", features: ["Gest√£o de pacientes (ilimitado)", "Agendamento inteligente com lembretes", "Gest√£o financeira b√°sica", "Resultados de exames online", "Suporte priorit√°rio por chat"], isPopular: true },
                { name: "Premium", price: "R$ 499/m√™s", features: ["Todas as funcionalidades do Profissional", "Gest√£o completa de funcion√°rios e m√©dicos", "Controle de estoque", "Consultas online (telemedicina)", "Suporte 24/7 dedicado", "Recursos avan√ßados de IA"], isPopular: false },
            ];
            return (
                <section id="planos" className="mb-24 py-16 bg-gradient-to-br from-emerald-50 to-lime-50 rounded-3xl shadow-xl border border-emerald-100">
                    <h2 className="text-5xl font-extrabold text-center text-emerald-800 mb-12 leading-tight">Escolha o Plano Ideal para a Sua Cl√≠nica</h2>
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-10 max-w-6xl mx-auto px-4">
                        {plans.map((plan, index) => <PlanCard key={index} plan={plan} />)}
                    </div>
                </section>
            );
        };
        
        // --- Componente AIChatBot ---
        const AIChatBot = () => {
          const [messages, setMessages] = useState([]);
          const [input, setInput] = useState('');
          const [isLoading, setIsLoading] = useState(false);

          const handleSendMessage = async () => {
            if (input.trim() === '') return;

            const userMessage = { sender: 'user', text: input };
            setMessages((prev) => [...prev, userMessage]);
            setInput('');
            setIsLoading(true);

            const prompt = `Voc√™ √© um assistente de sa√∫de. Com base nos seguintes sintomas, forne√ßa informa√ß√µes gerais e orienta√ß√µes sobre quando procurar um m√©dico. N√ÉO forne√ßa diagn√≥sticos. Sintomas: ${userMessage.text}`;
            const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };
            const apiKey = ""; 
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

            try {
              const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
              });
              const result = await response.json();
              const aiResponseText = result.candidates[0].content.parts[0].text;
              setMessages((prev) => [...prev, { sender: 'ai', text: aiResponseText }]);
            } catch (error) {
              console.error("Erro na API Gemini:", error);
              setMessages((prev) => [...prev, { sender: 'ai', text: 'Desculpe, ocorreu um erro. Tente novamente.' }]);
            } finally {
              setIsLoading(false);
            }
          };

          return (
            <div className="max-w-2xl mx-auto bg-emerald-50 p-8 rounded-2xl shadow-inner border border-emerald-100">
              <h3 className="text-3xl font-bold text-center text-emerald-700 mb-6">Orientador de Sintomas ‚ú®</h3>
              <div className="h-72 overflow-y-auto mb-6 p-4 bg-white rounded-lg border">
                {messages.map((msg, index) => (
                  <div key={index} className={`mb-3 p-4 rounded-xl max-w-[85%] text-lg ${msg.sender === 'user' ? 'bg-emerald-200 ml-auto' : 'bg-gray-100'}`}>
                    {msg.text}
                  </div>
                ))}
                {isLoading && <div className="p-4 rounded-xl bg-gray-100">A pensar...</div>}
              </div>
              <div className="flex">
                <input type="text" className="flex-grow px-5 py-3 border rounded-l-xl" placeholder="Ex: dor de cabe√ßa e febre" value={input} onChange={(e) => setInput(e.target.value)} onKeyPress={(e) => e.key === 'Enter' && handleSendMessage()} disabled={isLoading} />
                <button onClick={handleSendMessage} className="bg-emerald-700 text-white font-bold py-3 px-8 rounded-r-xl" disabled={isLoading}>Perguntar</button>
              </div>
            </div>
          );
        };

        // --- Componente AISection ---
        const AISection = () => (
          <section id="ia" className="mb-24 py-16 bg-white p-12 rounded-3xl shadow-xl">
            <h2 className="text-5xl font-extrabold text-center text-emerald-800 mb-10">Intelig√™ncia Artificial na Sua Cl√≠nica</h2>
            <p className="text-xl text-center max-w-4xl mx-auto leading-relaxed mb-12 text-gray-700">
                A IA √© a sua aliada para otimizar processos, personalizar o atendimento e impulsionar o desempenho da sua cl√≠nica.
            </p>
            <div className="grid md:grid-cols-2 gap-12 mb-16">
                <FeatureCard title="Otimiza√ß√£o de Processos" description="Automatize tarefas, otimize agendamentos e gira o fluxo de trabalho com algoritmos inteligentes." icon="üß†" />
                <FeatureCard title="An√°lise de Dados Avan√ßada" description="Obtenha insights valiosos sobre o desempenho da cl√≠nica e tend√™ncias de pacientes." icon="üìä" />
            </div>
            <AIChatBot />
          </section>
        );

        // --- Componente VideoSection (Atualizado) ---
        const VideoSection = ({ siteConfig }) => (
          <section id="video" className="mb-24 py-16 bg-gradient-to-br from-purple-50 to-pink-50 p-12 rounded-3xl shadow-xl">
            <h2 className="text-5xl font-extrabold text-center text-emerald-800 mb-10">
                {siteConfig.videoSectionTitle || "Veja a Nossa Cl√≠nica em A√ß√£o"}
            </h2>
            <p className="text-xl text-center max-w-4xl mx-auto leading-relaxed mb-12 text-gray-700">
                {siteConfig.videoSectionSubtitle || "Explore as nossas instala√ß√µes e conhe√ßa a nossa equipa atrav√©s deste v√≠deo de apresenta√ß√£o."}
            </p>
            <div className="max-w-4xl mx-auto rounded-2xl shadow-2xl overflow-hidden border-4 border-white bg-black">
                <video
                    key={siteConfig.videoSectionUrl}
                    className="w-full h-full"
                    controls
                    src={siteConfig.videoSectionUrl}
                >
                    O seu navegador n√£o suporta a tag de v√≠deo.
                </video>
            </div>
          </section>
        );

        // --- Componente SecuritySection ---
        const SecuritySection = () => (
            <section id="seguranca" className="mb-24 py-16 bg-gradient-to-br from-blue-50 to-indigo-50 p-12 rounded-3xl shadow-xl">
                <h2 className="text-5xl font-extrabold text-center text-emerald-800 mb-10">A Sua Seguran√ßa √© a Nossa Prioridade</h2>
                <p className="text-xl text-center max-w-4xl mx-auto leading-relaxed mb-12 text-gray-700">
                    A nossa plataforma √© constru√≠da com as mais avan√ßadas tecnologias para garantir a prote√ß√£o completa das suas informa√ß√µes.
                </p>
                <div className="grid md:grid-cols-3 gap-12">
                    <FeatureCard title="Criptografia Avan√ßada" description="Todos os seus dados s√£o criptografados de ponta a ponta." icon="üîí" />
                    <FeatureCard title="Conformidade com LGPD" description="Seguimos rigorosamente as diretrizes da Lei Geral de Prote√ß√£o de Dados." icon="üõ°Ô∏è" />
                    <FeatureCard title="Auditorias Constantes" description="Os nossos sistemas passam por auditorias de seguran√ßa regulares." icon="‚úÖ" />
                </div>
            </section>
        );

        // --- Componente PatientExamsSection (Se√ß√£o de Exames do Paciente) ---
        const PatientExamsSection = ({ userId }) => {
            const [exams, setExams] = useState([]);
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState(null);

            useEffect(() => {
                if (!db || !userId) {
                    setLoading(false);
                    return;
                }
                setLoading(true);
                setError(null);
                const examsCollectionRef = collection(db, `artifacts/${appId}/users/${userId}/exams`);
                const unsubscribe = onSnapshot(examsCollectionRef, (snapshot) => {
                    const patientExams = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    patientExams.sort((a, b) => (b.timestamp?.toDate() || 0) - (a.timestamp?.toDate() || 0));
                    setExams(patientExams);
                    setLoading(false);
                }, (err) => {
                    console.error("Erro ao procurar exames:", err);
                    setError("N√£o foi poss√≠vel carregar os exames.");
                    setLoading(false);
                });
                return () => unsubscribe();
            }, [userId]);

            const handleAddSampleExam = async () => {
                if (!db || !userId) return;
                try {
                    const newExam = {
                        examType: `Exame de Rotina ${Math.floor(Math.random() * 100)}`,
                        result: "Resultado simulado: Tudo dentro dos par√¢metros normais.",
                        timestamp: new Date(),
                        patientId: userId,
                        clinicNotes: "Acompanhamento de rotina.",
                    };
                    await addDoc(collection(db, `artifacts/${appId}/users/${userId}/exams`), newExam);
                } catch (e) {
                    console.error("Erro ao adicionar exame de amostra: ", e);
                }
            };

            return (
                <section id="exames" className="mb-24 py-16 bg-white p-12 rounded-3xl shadow-xl border border-gray-50">
                    <h2 className="text-5xl font-extrabold text-center text-emerald-800 mb-10 leading-tight">Meus Exames</h2>
                    <p className="text-xl text-center max-w-4xl mx-auto leading-relaxed text-gray-700">Aceda aos seus resultados de exames em tempo real, com seguran√ßa e privacidade.</p>
                    <div className="text-center my-8">
                        <p className="text-md text-emerald-700 font-semibold mt-4">O seu ID de Utilizador: <span className="font-normal text-gray-800 bg-gray-100 p-1 rounded">{userId}</span></p>
                        <button onClick={handleAddSampleExam} className="mt-4 bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3 px-8 rounded-xl shadow-lg transition duration-300 transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-emerald-300">
                            Adicionar Exame de Amostra
                        </button>
                    </div>
                    {loading && <p className="text-center text-emerald-600 text-xl">A carregar os seus exames...</p>}
                    {error && <p className="text-center text-red-600 text-xl">{error}</p>}
                    {!loading && exams.length === 0 && !error && <p className="text-center text-gray-600 text-xl">Nenhum exame encontrado. Adicione um exame de amostra!</p>}
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mt-12">
                        {exams.map((exam) => (
                            <div key={exam.id} className="bg-emerald-50 p-6 rounded-2xl shadow-md border border-emerald-100">
                                <h3 className="text-2xl font-bold text-emerald-800 mb-3">{exam.examType}</h3>
                                <p className="text-gray-700 mb-2"><span className="font-semibold">Resultado:</span> {exam.result}</p>
                                <p className="text-gray-600 text-sm"><span className="font-semibold">Data:</span> {exam.timestamp ? new Date(exam.timestamp.toDate()).toLocaleString() : 'N/A'}</p>
                            </div>
                        ))}
                    </div>
                </section>
            );
        };

        // --- Componente AdminPanel (Painel de Administra√ß√£o) ---
        const AdminPanel = ({ updateSiteConfig, siteConfig }) => {
            const [config, setConfig] = useState(siteConfig);

            useEffect(() => {
                setConfig(siteConfig);
            }, [siteConfig]);

            const handleChange = (key, value) => {
                setConfig(prev => ({ ...prev, [key]: value }));
            };
            
            const handleBlur = (key, value) => {
                updateSiteConfig(key, value);
            };

            const handleKeyPress = (e, key, value) => {
                if (e.key === 'Enter') {
                    updateSiteConfig(key, value);
                    e.target.blur();
                }
            };

            return (
                <section id="admin-panel" className="mb-24 py-16 bg-gray-100 p-12 rounded-3xl shadow-xl border border-gray-200">
                    <h2 className="text-5xl font-extrabold text-center text-emerald-800 mb-10 leading-tight">Painel de Administra√ß√£o</h2>
                    <p className="text-xl text-center max-w-4xl mx-auto leading-relaxed mb-12 text-gray-700">Edite o conte√∫do do site em tempo real. As altera√ß√µes s√£o guardadas automaticamente ao sair do campo ou ao pressionar Enter.</p>
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-7xl mx-auto">
                        <div className="bg-white p-6 rounded-xl shadow-md border border-gray-100 space-y-4">
                            <h3 className="text-2xl font-bold text-emerald-700">Se√ß√£o Principal (Hero)</h3>
                            <div>
                                <label className="block text-gray-700 text-sm font-bold mb-2">URL do V√≠deo de Fundo:</label>
                                <input type="text" value={config.heroVideoUrl || ''} onChange={(e) => handleChange('heroVideoUrl', e.target.value)} onBlur={(e) => handleBlur('heroVideoUrl', e.target.value)} onKeyPress={(e) => handleKeyPress(e, 'heroVideoUrl', e.target.value)} className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700"/>
                            </div>
                            <div>
                                <label className="block text-gray-700 text-sm font-bold mb-2">T√≠tulo Principal:</label>
                                <input type="text" value={config.heroTitle || ''} onChange={(e) => handleChange('heroTitle', e.target.value)} onBlur={(e) => handleBlur('heroTitle', e.target.value)} onKeyPress={(e) => handleKeyPress(e, 'heroTitle', e.target.value)} className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700"/>
                            </div>
                        </div>
                        <div className="bg-white p-6 rounded-xl shadow-md border border-gray-100 space-y-4">
                            <h3 className="text-2xl font-bold text-emerald-700">Se√ß√£o de V√≠deo</h3>
                            <div>
                                <label className="block text-gray-700 text-sm font-bold mb-2">Caminho do V√≠deo:</label>
                                <input type="text" value={config.videoSectionUrl || ''} onChange={(e) => handleChange('videoSectionUrl', e.target.value)} onBlur={(e) => handleBlur('videoSectionUrl', e.target.value)} onKeyPress={(e) => handleKeyPress(e, 'videoSectionUrl', e.target.value)} className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700"/>
                            </div>
                             <div>
                                <label className="block text-gray-700 text-sm font-bold mb-2">T√≠tulo da Se√ß√£o de V√≠deo:</label>
                                <input type="text" value={config.videoSectionTitle || ''} onChange={(e) => handleChange('videoSectionTitle', e.target.value)} onBlur={(e) => handleBlur('videoSectionTitle', e.target.value)} onKeyPress={(e) => handleKeyPress(e, 'videoSectionTitle', e.target.value)} className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700"/>
                            </div>
                             <div>
                                <label className="block text-gray-700 text-sm font-bold mb-2">Subt√≠tulo da Se√ß√£o de V√≠deo:</label>
                                <input type="text" value={config.videoSectionSubtitle || ''} onChange={(e) => handleChange('videoSectionSubtitle', e.target.value)} onBlur={(e) => handleBlur('videoSectionSubtitle', e.target.value)} onKeyPress={(e) => handleKeyPress(e, 'videoSectionSubtitle', e.target.value)} className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700"/>
                            </div>
                        </div>
                        <div className="bg-white p-6 rounded-xl shadow-md border border-gray-100 space-y-4">
                            <h3 className="text-2xl font-bold text-emerald-700">Configura√ß√µes Gerais</h3>
                            <div>
                                <label className="block text-gray-700 text-sm font-bold mb-2">Nome da Cl√≠nica:</label>
                                <input type="text" value={config.clinicName || ''} onChange={(e) => handleChange('clinicName', e.target.value)} onBlur={(e) => handleBlur('clinicName', e.target.value)} onKeyPress={(e) => handleKeyPress(e, 'clinicName', e.target.value)} className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700"/>
                            </div>
                            <div>
                                <label className="block text-gray-700 text-sm font-bold mb-2">Imagem da Se√ß√£o "Sobre":</label>
                                <input type="text" value={config.aboutImage || ''} onChange={(e) => handleChange('aboutImage', e.target.value)} onBlur={(e) => handleBlur('aboutImage', e.target.value)} onKeyPress={(e) => handleKeyPress(e, 'aboutImage', e.target.value)} className="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700"/>
                            </div>
                        </div>
                    </div>
                </section>
            );
        };
        
        // --- Componente Footer (Rodap√©) ---
        const Footer = ({ siteConfig }) => (
            <footer className="bg-gray-900 text-white py-14 px-4 rounded-t-3xl">
                <div className="container mx-auto grid grid-cols-1 md:grid-cols-3 gap-12 border-b border-gray-700 pb-10 mb-10">
                    <div>
                        <h4 className="text-3xl font-extrabold text-emerald-400 mb-5">{siteConfig.clinicName || "Cl√≠nica Inteligente"}</h4>
                        <p className="text-gray-400 leading-relaxed text-lg">A inovar a gest√£o de cl√≠nicas e a experi√™ncia do paciente.</p>
                    </div>
                    <div>
                        <h4 className="text-3xl font-extrabold text-emerald-400 mb-5">Links R√°pidos</h4>
                        <ul className="space-y-3">
                            {siteConfig.navLinks && siteConfig.navLinks.map((link, index) => (
                                <li key={index}><a href={link.href} className="text-gray-400 hover:text-emerald-300 transition duration-300 text-lg">{link.text}</a></li>
                            ))}
                        </ul>
                    </div>
                    <div>
                        <h4 className="text-3xl font-extrabold text-emerald-400 mb-5">Fale Conosco</h4>
                        <p className="text-gray-400 mb-3 text-lg">Rua da Inova√ß√£o, 123, Cidade Futura - BR</p>
                        <p className="text-gray-400 text-lg">contacto@clinicainteligente.com</p>
                    </div>
                </div>
                <div className="text-center text-gray-500 text-base mt-8">
                    &copy; {new Date().getFullYear()} Cl√≠nica Inteligente. Todos os direitos reservados.
                </div>
            </footer>
        );

        // --- Componente Principal da Aplica√ß√£o ---
        const App = () => {
            const [userId, setUserId] = useState(null);
            const [isAuthReady, setIsAuthReady] = useState(false);
            const [siteConfig, setSiteConfig] = useState({
                // ALTERA√á√ÉO: URL do v√≠deo do cabe√ßalho atualizada para o caminho local fornecido.
                heroVideoUrl: "imagens/video capa clinica medida oficial.mp4",
                // ALTERA√á√ÉO: Imagem de poster gen√©rica.
                heroPosterUrl: "https://placehold.co/1920x1080/D0F0E0/000000?text=A+carregar+o+v√≠deo...",
                heroTitle: "A Sua Cl√≠nica, Mais Inteligente.",
                heroSubtitle: "Inova√ß√£o e efici√™ncia para a gest√£o m√©dica.",
                heroButtonText: "Saiba Mais",
                heroButtonLink: "#sobre",
                clinicName: "Cl√≠nica Inteligente",
                navLinks: [
                    { href: "#sobre", text: "Sobre" },
                    { href: "#servicos", text: "Servi√ßos" },
                    { href: "#video", text: "V√≠deo" },
                    { href: "#ia", text: "IA" },
                    { href: "#planos", text: "Planos" },
                    { href: "#exames", text: "Exames" },
                    { href: "#seguranca", text: "Seguran√ßa" },
                    { href: "#contato", text: "Contacto" },
                ],
                aboutImage: "https://placehold.co/1200x400/D0F0E0/000000?text=M√©dicos+a+interagir",
                // ALTERA√á√ÉO: URL da se√ß√£o de v√≠deo atualizada para o caminho local fornecido.
                videoSectionUrl: "imagens/video capa clinica medida oficial.mp4",
                videoSectionTitle: "Conhe√ßa a Nossa Estrutura",
                videoSectionSubtitle: "Um tour virtual pelas nossas instala√ß√µes modernas e acolhedoras."
            });

            useEffect(() => {
                if (Object.keys(firebaseConfig).length === 0) {
                    console.warn("Configura√ß√£o do Firebase n√£o encontrada. A usar modo offline.");
                    setIsAuthReady(true);
                    setUserId(crypto.randomUUID());
                    return;
                }
                
                app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);

                onAuthStateChanged(auth, async (user) => {
                    if (user) {
                        setUserId(user.uid);
                    } else {
                        try {
                            const token = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
                            if (token) {
                                await signInWithCustomToken(auth, token);
                            } else {
                                await signInAnonymously(auth);
                            }
                            setUserId(auth.currentUser?.uid);
                        } catch (error) {
                            console.error("Erro na autentica√ß√£o:", error);
                            setUserId(crypto.randomUUID());
                        }
                    }
                    setIsAuthReady(true);
                });
            }, []);

            useEffect(() => {
                if (!isAuthReady || !db) return;

                const configDocRef = doc(db, `artifacts/${appId}/public/data/siteConfigurations/mainDoc`);
                
                const unsubscribe = onSnapshot(configDocRef, (docSnap) => {
                    if (docSnap.exists()) {
                        setSiteConfig(prevConfig => ({ ...prevConfig, ...docSnap.data() }));
                    } else {
                        setDoc(configDocRef, siteConfig);
                    }
                }, (error) => {
                    console.error("Erro ao carregar configura√ß√£o do site:", error);
                });

                return () => unsubscribe();
            }, [isAuthReady]);

            const updateSiteConfig = async (key, value) => {
                if (!db) return;
                const configDocRef = doc(db, `artifacts/${appId}/public/data/siteConfigurations/mainDoc`);
                try {
                    await setDoc(configDocRef, { [key]: value }, { merge: true });
                } catch (e) {
                    console.error("Erro ao atualizar configura√ß√£o:", e);
                }
            };

            if (!isAuthReady) {
                return (
                    <div className="min-h-screen flex items-center justify-center bg-emerald-50">
                        <p className="text-2xl text-emerald-700 font-semibold">A carregar a aplica√ß√£o...</p>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gradient-to-br from-emerald-50 to-white font-sans text-gray-800">
                    <HeroSection siteConfig={siteConfig} />
                    <Navbar userId={userId} siteConfig={siteConfig} />
                    <main className="container mx-auto px-4 py-16">
                        <section id="sobre" className="mb-24 bg-white p-12 rounded-3xl shadow-xl border border-gray-50">
                            <h2 className="text-5xl font-extrabold text-center text-emerald-800 mb-10">Sobre N√≥s</h2>
                            <p className="text-xl text-center max-w-4xl mx-auto leading-relaxed text-gray-700">
                                A nossa cl√≠nica dedica-se a oferecer excel√™ncia em cuidados de sa√∫de, combinando tecnologia de ponta com um atendimento humano e personalizado.
                            </p>
                            <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-10 mt-16">
                                <FeatureCard title="Administra√ß√£o Simplificada" description="Ferramentas intuitivas para gerir a sua cl√≠nica de forma eficiente." icon="‚öôÔ∏è" />
                                <FeatureCard title="Gest√£o Financeira" description="Controle pagamentos e acompanhe o fluxo de caixa com precis√£o." icon="üí∞" />
                                <FeatureCard title="Cadastro de Pacientes" description="Mantenha um registo detalhado e seguro de todos os seus pacientes." icon="üìã" />
                                <FeatureCard title="Agendamento Inteligente" description="Facilite o agendamento de consultas e exames online." icon="üóìÔ∏è" />
                                <FeatureCard title="Resultados Online" description="Acesso r√°pido e seguro aos resultados de exames para pacientes e m√©dicos." icon="üî¨" />
                                <FeatureCard title="Consultas Online" description="Plataforma para teleconsultas com qualidade de v√≠deo superior." icon="üíª" />
                            </div>
                            <div className="mt-16 text-center">
                                <img src={siteConfig.aboutImage} alt="M√©dicos na cl√≠nica" className="w-full max-w-4xl mx-auto rounded-2xl shadow-lg border border-gray-100" />
                            </div>
                        </section>
                        <section id="servicos" className="mb-24 bg-gradient-to-br from-emerald-50 to-white p-12 rounded-3xl shadow-xl border border-emerald-100">
                            <h2 className="text-5xl font-extrabold text-center text-emerald-800 mb-10">Os Nossos Servi√ßos</h2>
                            <div className="grid md:grid-cols-2 gap-12 text-lg text-gray-700">
                                <div>
                                    <h3 className="text-3xl font-bold text-emerald-700 mb-4">Para a Cl√≠nica</h3>
                                    <ul className="list-disc list-inside space-y-2">
                                        <li>Gest√£o de prontu√°rios eletr√≥nicos seguros.</li>
                                        <li>Controlo de stock de medicamentos e insumos.</li>
                                        <li>Relat√≥rios financeiros e de desempenho.</li>
                                    </ul>
                                </div>
                                <div>
                                    <h3 className="text-3xl font-bold text-emerald-700 mb-4">Para os Pacientes</h3>
                                    <ul className="list-disc list-inside space-y-2">
                                        <li>Agendamento online 24/7, f√°cil e r√°pido.</li>
                                        <li>Acesso seguro a resultados de exames.</li>
                                        <li>Hist√≥rico completo de consultas na palma da m√£o.</li>
                                    </ul>
                                </div>
                            </div>
                        </section>
                        <VideoSection siteConfig={siteConfig} />
                        <AISection />
                        <SubscriptionPlans />
                        <PatientExamsSection userId={userId} />
                        <SecuritySection />
                        <section id="contato" className="mb-24 bg-white p-12 rounded-3xl shadow-xl border border-gray-50">
                            <h2 className="text-5xl font-extrabold text-center text-emerald-800 mb-10">Entre em Contacto</h2>
                            <form className="max-w-xl mx-auto space-y-6">
                                <div>
                                    <label htmlFor="nome" className="block text-lg font-semibold text-gray-700">Nome</label>
                                    <input type="text" id="nome" className="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-xl shadow-sm"/>
                                </div>
                                <div>
                                    <label htmlFor="email" className="block text-lg font-semibold text-gray-700">Email</label>
                                    <input type="email" id="email" className="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-xl shadow-sm"/>
                                </div>
                                <div>
                                    <label htmlFor="mensagem" className="block text-lg font-semibold text-gray-700">Mensagem</label>
                                    <textarea id="mensagem" rows="5" className="mt-1 block w-full px-4 py-3 border border-gray-300 rounded-xl shadow-sm"></textarea>
                                </div>
                                <button type="submit" className="w-full bg-emerald-700 hover:bg-emerald-800 text-white font-bold py-4 px-8 rounded-xl shadow-lg transition duration-300 transform hover:scale-105">
                                    Enviar Mensagem
                                </button>
                            </form>
                        </section>
                        <AdminPanel updateSiteConfig={updateSiteConfig} siteConfig={siteConfig} />
                    </main>
                    <Footer siteConfig={siteConfig} />
                </div>
            );
        };

        // Renderiza a aplica√ß√£o React no elemento #root
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
